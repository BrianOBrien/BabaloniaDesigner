<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="https://github.com/avaloniaui/directive"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        x:Class="BabaloniaDesigner.MainWindow"
        Width="1300" Height="800"
        Background="#2b2b2b"
        Title="Babalonia Designer">

    <!-- Columns: Controls | Hierarchy | Properties | Preview -->
    <!-- Narrower first two, wider properties + preview -->
    <Grid ColumnDefinitions="150, 210, 360, *"
          RowDefinitions="Auto,*">

        <!-- ===== HEADERS ===== -->
        <TextBlock Grid.Row="0" Grid.Column="0"
                   Text="Controls"
                   FontWeight="Bold"
                   Foreground="White"
                   Margin="8,8,8,4"/>

        <TextBlock Grid.Row="0" Grid.Column="1"
                   Text="Hierarchy"
                   FontWeight="Bold"
                   Foreground="White"
                   Margin="8,8,8,4"/>

        <TextBlock Grid.Row="0" Grid.Column="2"
                   Text="Properties"
                   FontWeight="Bold"
                   Foreground="White"
                   Margin="8,8,8,4"/>

        <TextBlock Grid.Row="0" Grid.Column="3"
                   Text="Preview"
                   FontWeight="Bold"
                   Foreground="White"
                   Margin="8,8,8,4"/>

        <!-- ===== TOOLBOX ===== -->
        <ListBox Grid.Row="1" Grid.Column="0"
                 x:Name="ToolboxListBox"
                 ItemsSource="{Binding ToolboxItems}"
                 Background="#303030"
                 Foreground="White"
                 BorderThickness="0"
                 SelectedIndex="-1"
                 DoubleTapped="ToolboxListBox_OnDoubleTapped">

            <ListBox.Styles>
                <Style Selector="ListBoxItem">
                    <Setter Property="Padding" Value="4,2" />
                    <Setter Property="MinHeight" Value="20" />
                </Style>
            </ListBox.Styles>

            <ListBox.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Name}"
                               Margin="4,0"
                               Foreground="White"
                               FontSize="12" />
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <!-- ===== HIERARCHY ===== -->
        <TreeView Grid.Row="1"
                  Grid.Column="1"
                  x:Name="HierarchyTree"
                  ItemsSource="{Binding RootNodes}"
                  Background="#303030"
                  Foreground="White"
                  BorderThickness="0"
                  SelectionChanged="HierarchyTree_OnSelectionChanged">

            <TreeView.Styles>
                <!-- compact rows + selection/expansion binding -->
                <Style Selector="TreeViewItem">
                    <Setter Property="Padding" Value="2,0" />
                    <Setter Property="Margin" Value="0" />
                    <Setter Property="MinHeight" Value="18" />
                    <Setter Property="IsExpanded"
                            Value="{Binding IsExpanded, Mode=TwoWay}" />
                    <Setter Property="IsSelected"
                            Value="{Binding IsSelected, Mode=TwoWay}" />
                </Style>
            </TreeView.Styles>

            <TreeView.ItemTemplate>
                <TreeDataTemplate ItemsSource="{Binding Children}">
                    <TextBlock Text="{Binding DisplayName}"
                               Foreground="White"
                               Margin="4,0"
                               FontSize="12"/>
                </TreeDataTemplate>
            </TreeView.ItemTemplate>
        </TreeView>

        <!-- ===== PROPERTIES ===== -->
        <Grid Grid.Column="2" Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Selected control name -->
            <TextBlock Grid.Row="0"
                       Text="{Binding SelectedNode.DisplayName}"
                       Foreground="LightGreen"
                       Margin="8,0,8,4"
                       FontSize="12" />

            <!-- Property grid -->
            <ListBox Grid.Row="1"
                     x:Name="PropertiesListBox"
                     ItemsSource="{Binding SelectedProperties}"
                     Background="#3a3a3a"
                     BorderThickness="0"
                     Foreground="White"
                     Padding="0,0,12,12"
                     ScrollViewer.HorizontalScrollBarVisibility="Disabled">

                <ListBox.Styles>
                    <Style Selector="ListBoxItem">
                        <Setter Property="Padding" Value="0" />
                        <Setter Property="Margin" Value="0,0,0,1" />
                        <Setter Property="MinHeight" Value="20" />
                    </Style>
                </ListBox.Styles>

                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <!-- Auto for label, * for editor -->
                        <Grid ColumnDefinitions="Auto,*">
                            <TextBlock Text="{Binding Name}"
                                       Margin="6,0,4,0"
                                       VerticalAlignment="Center"
                                       FontSize="12"
                                       TextTrimming="CharacterEllipsis" />
                            <TextBox Grid.Column="1"
                                     Text="{Binding Value, Mode=TwoWay}"
                                     Margin="0"
                                     Height="20"
                                     VerticalContentAlignment="Center"
                                     Background="#2b2b2b"
                                     Foreground="White"
                                     BorderBrush="#555"
                                     FontSize="12"/>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </Grid>

        <!-- ===== PREVIEW ===== -->
        <Border Grid.Column="3"
                Grid.Row="1"
                Margin="8,0,8,8"
                Background="#1a1a1a"
                CornerRadius="4"
                BorderBrush="#555"
                BorderThickness="1">
            <ContentPresenter Content="{Binding PreviewRoot}"
                              Margin="16"/>
        </Border>

    </Grid>
</Window>
